CREATE OR REPLACE TABLE DEMO_DB.PUBLIC.RetailSalesFact AS
SELECT
        S.STORE_NAME,
        S.STORE_CITY,
        S.STORE_STATE,
        P.PRODUCT_NAME,
        SUM(R.QUANTITY) AS QUANTITY,
        SUM(R.SALES_AMOUNT) AS SALES_AMOUNT
    FROM DIM_FACT_DB.PUBLIC.STORE_DIM AS S
    JOIN DIM_FACT_DB.PUBLIC.RetailSalesFact AS R 
    ON S.STORE_KEY = R.STORE_KEY
    JOIN DIM_FACT_DB.PUBLIC.PRODUCT_DIM AS P 
    ON R.PRODUCT_KEY = P.PRODUCT_KEY
    GROUP BY
        S.STORE_NAME,
        S.STORE_CITY,
        S.STORE_STATE,
        P.PRODUCT_NAME;
